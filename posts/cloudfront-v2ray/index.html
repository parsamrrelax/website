<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Setup Amazon Cloudfront as cdn domain for V2ray :: Parsa | Tech Content</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Learn how to set up an Amazon CloudFront CDN for v2ray using X-UI, including domain management with Cloudflare and configuring custom SSL certificates. This guide provides step-by-step instructions for creating secure and optimized configurations." />
<meta name="keywords" content="Amazon CloudFront CDN, v2ray setup, X-UI configuration, Cloudflare domain management, AWS CloudFront distribution, TLS configurations v2ray, Custom SSL certificate AWS, Cloudflare CNAME record, X-UI vps settings, Cloudfront certificate validation" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/posts/cloudfront-v2ray/" />


  





  
  <link rel="stylesheet" href="/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="/css/code.min.af657adb93522babb6c0398ecf30a3f25ef4e1e5106b0f7d9a423e0beeba576e.css">

  
  <link rel="stylesheet" href="/css/fonts.min.23057e40db67c96fd98b1bd73002e3c7c370bacb18f4a48eee12a4f3075a93d2.css">

  
  <link rel="stylesheet" href="/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="/css/main.min.25ab35b4ef392af8f0aa6590b50283f72549f4b2df6de27e93db60b961b85324.css">

  
  <link rel="stylesheet" href="/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css">

  
  <link rel="stylesheet" href="/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css">

  
  <link rel="stylesheet" href="/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css">

  
  <link rel="stylesheet" href="/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css">

  
  <link rel="stylesheet" href="/css/terminal.min.c47f69d223279396198407f773f37f0a49d8f303973bcc1fc44f6c17fd18b88b.css">

  
  <link rel="stylesheet" href="/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="/terminal.css">




<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Setup Amazon Cloudfront as cdn domain for V2ray">
<meta property="og:description" content="Learn how to set up an Amazon CloudFront CDN for v2ray using X-UI, including domain management with Cloudflare and configuring custom SSL certificates. This guide provides step-by-step instructions for creating secure and optimized configurations." />
<meta property="og:url" content="/posts/cloudfront-v2ray/" />
<meta property="og:site_name" content="Parsa | Tech Content" />

  
  
  <meta property="og:image" content="/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-01-19 20:04:00 &#43;0330 &#43;0330" />












</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Parsa | Tech Content
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
      
        <hr />
        
          <li>
            <a href="/">English</a>
          </li>
        
          <li>
            <a href="/fa/">Persian</a>
          </li>
        
      
    </ul>
  </li>
</ul>

    
    
      <ul class="menu menu--desktop menu--language-selector">
  <li class="menu__trigger">English&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        <li><a href="/">English</a></li>
      
        <li><a href="/fa/">Persian</a></li>
      
    </ul>
  </li>
</ul>

    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/posts/cloudfront-v2ray/">Setup Amazon Cloudfront as cdn domain for V2ray</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-01-19</time></div>

  
    <span class="post-tags">
      
      #<a href="/tags/cloudfront/">CloudFront</a>&nbsp;
      
      #<a href="/tags/v2ray/">v2ray</a>&nbsp;
      
      #<a href="/tags/x-ui/">X-UI</a>&nbsp;
      
      #<a href="/tags/cloudflare/">Cloudflare</a>&nbsp;
      
      #<a href="/tags/aws-setup/">AWS setup</a>&nbsp;
      
      #<a href="/tags/tls/">TLS</a>&nbsp;
      
      #<a href="/tags/cdn/">CDN</a>&nbsp;
      
      #<a href="/tags/ssl-certificate/">SSL certificate</a>&nbsp;
      
      #<a href="/tags/vps-configuration/">VPS configuration</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h1 id="how-to-setup-an-amazon-cloudfront-cdn-for-v2ray-specifically-in-x-ui">How to setup an Amazon Cloudfront cdn for v2ray specifically in X-UI<a href="#how-to-setup-an-amazon-cloudfront-cdn-for-v2ray-specifically-in-x-ui" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<h2 id="requirements">Requirements<a href="#requirements" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>Of course you need to have an amazon account setup and verified. It needs your credit card information to verify your account. However there will be no charges and the free tier is 1TB a month for CDN plus there are other free services you can use as well.</li>
<li>You need a VPS running some form of X-UI. I&rsquo;ll be using <a href="github.com/MHSanaei/3x-ui">3X-UI</a>.</li>
<li>A domain name that is not the country code of a sanctioned country like ru or ir.</li>
<li>Basic knowledge of creating configurations with X-UI.</li>
</ul>
<h2 id="getting-started">Getting started<a href="#getting-started" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>I&rsquo;m using Cloudflare to manage my domains and records. I suggest you do the same but the instructions are similar no matter the route you choose to take.</p>
<p>Create an A record from your domain to your vps IP address. Let&rsquo;s call it <code>sub1.domain.com</code>.</p>
<p><em>If you&rsquo;re using Cloudflare the proxy checkmark should be off</em></p>
<h2 id="aws">AWS<a href="#aws" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>In aws search for cloudfront and create a distribution.
You&rsquo;ll see a screen with a lot of fields to enter information. Must of it is fine as is but we&rsquo;ll get to what you need to change.</p>
<ul>
<li>For origin name enter the subdomain pointing to your vps aka <code>sub1.domain.com</code>.</li>
<li>Protocol select match viewer so you can create both tls and non tls configurations for your v2ray.</li>
<li>Compress objects automatically <code>no</code>.</li>
<li>Tap on Cache Policy and choose <code>CachingDisabled</code>.</li>
<li>Further down check <code>Do not enable security protections</code>.</li>
</ul>
<p>That&rsquo;s the changes for this part. Tap on create distribution.
<em>If you get a message saying your account needs to be verified but your payment information is correct, search for ec2 in aws console and start a remote machine and play with it for a while. It should auto trigger the verification</em></p>
<p>You&rsquo;ll see a page with a domain name inside it generally ending with cloudfront.net. It should be under <code>Distribution Domain Name</code>.</p>
<p>Copy it.</p>
<h2 id="back-to-cloudflare">Back to Cloudflare<a href="#back-to-cloudflare" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>In Cloudflare now we need to create another subdomain. Let&rsquo;s call it <code>sub2.domain.com</code>.</p>
<p>Create a CNAME record pointing <code>sub2.domain.com</code> to the url you got that you copied in the previous step.
<em>again make sure proxy is checked off</em></p>
<h2 id="get-certificate-from-aws">Get certificate from AWS<a href="#get-certificate-from-aws" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Head back to your Cloudfront console. Under <strong>general</strong> tab there&rsquo;s a section called <strong>Settings</strong> inside it tap on the <strong>edit</strong> button.</p>
<p>In the new section choose <code>Alternate Domain Name (CNAME) - Optional</code>. Click on add item and enter the second subdomain in this example <code>sub2.domain.com</code>.</p>
<p>Head over to <code>Custom SSL Certificate - Optional</code> and click <strong>request certificate</strong>.</p>
<p>In the new page under domain name enter <code>sub2.domain.com</code> and leave other values as is. And tap on <strong>request</strong>.</p>
<p>You&rsquo;ll see under certificate section that certificate is pending validation.</p>
<p>Tap on ID and in the new page under Domains you&rsquo;ll see some information including <code>CNAME name</code> and <code>CNAME value</code>. Keep this tab open.</p>
<h2 id="verifying-your-domain-on-cloudflare">Verifying your domain on Cloudflare<a href="#verifying-your-domain-on-cloudflare" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Back in Cloudflare create another CNAME subdomain. For name enter <code>CNAME name</code> and for target enter <code>CNAME value</code> that you got from the previous step.</p>
<p>Now if you check your Cloudfront tab and refresh it. You&rsquo;ll see it now says issued instead of pending.</p>
<p>Now back to the distribution settings from where you were getting your certificate. Under <strong>Custom SSL</strong> you can now choose the certificate that you just got for you domain. Choose it and don&rsquo;t touch anything else. Tap <strong>Save Changes</strong>.</p>
<p>Now wait a bit until you the last modified section change from deploying to a date and time. It might take a couple of minutes so don&rsquo;t worry and refresh the page once in a while.</p>
<p>After you see a date and time go to next section.</p>
<h2 id="getting-a-certificate-for-your-domain-on-your-vps">Getting a certificate for your domain on your VPS<a href="#getting-a-certificate-for-your-domain-on-your-vps" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>In your vps get a certificate for <code>sub2.domain.com</code>. There are many tools and tutorials for this so I won&rsquo;t go through it but you should in the end get a public key and a private key file for your sub domain.</p>
<h2 id="x-ui-settings">X-UI Settings<a href="#x-ui-settings" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Now you need to create a configuration in x-ui. We will be using TLS in this config so make sure port 443 is free on your VPS. If it&rsquo;s not you can check what&rsquo;s taking it with this command. <code>netstat -tulpn | grep 443</code></p>
<p>Create a configuration like you see below.
You can choose path name and name as you wish.</p>
<p>
<img src="v2ray1.jpg"  alt="v2ray configuration"  class="center"  style="border-radius: 8px;"    />



<img src="v2ray2.jpg"  alt="v2ray configuration"  class="center"  style="border-radius: 8px;"    />

</p>
<p>That&rsquo;s it. Export your configuration. And import it in your client. Edit the config. You can see in the address bar right now your VPS IP address is chosen by default. You can change this IP address to any website or IP that is also on Cloudfront. You can also use the domain that cloudfront gave you in a previous step. Paste it in and save the configuration.</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="/posts/telegram-bot-api/" class="button inline prev">
        Hosting Telegram Bot API
      </a>
    
    
      ::
    
    
      <a href="/posts/revancedfiles6/" class="button inline next">
        Revanced Apks (YouTube) 30 Nov 2024
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
